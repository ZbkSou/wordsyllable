# 音节查询单词接口文档

## 接口信息

**接口名称：** 根据音节查询相关单词

**接口地址：** `GET /api/syllables/words`

**认证要求：** 需要 JWT Token

**功能描述：** 输入一个音节，返回包含该音节的所有单词的完整信息（不记录查询次数）

---

## 请求参数

### Query Parameters

| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| syllable | string | 是 | - | 要查询的音节，如 "con", "ver", "tion" 等 |
| page | integer | 否 | 1 | 页码，从1开始 |
| per_page | integer | 否 | 50 | 每页数量，最小50条 |

**注意：**
- `syllable` 参数会自动转换为小写
- `per_page` 如果传入小于50的值，会自动设置为50

---

## 响应格式

### 成功响应 (200 OK)

```json
{
  "syllable": "con",
  "words": [
    {
      "id": 1,
      "word": "conversation",
      "translation": "会话，谈话",
      "phonetic": "/ˌkɒnvəˈseɪʃən/",
      "phonetic_analysis": "con-辅音+元音组合/kɒn/，ver-元音er组合/və/，sa-辅音+元音/seɪ/，tion-常见后缀/ʃn/",
      "root_affix": "前缀con-(共同)，词根vers(转)，后缀-ation(名词后缀)",
      "syllables": ["con", "ver", "sa", "tion"],
      "created_at": "2025-11-19T12:00:00"
    },
    {
      "id": 2,
      "word": "consider",
      "translation": "考虑，认为",
      "phonetic": "/kənˈsɪdə(r)/",
      "phonetic_analysis": "con-弱读/kən/，sid-词根/sɪd/，er-后缀/ə(r)/",
      "root_affix": "前缀con-(共同)，词根sid(坐)，后缀-er(动词)",
      "syllables": ["con", "sid", "er"],
      "created_at": "2025-11-19T12:05:00"
    }
  ],
  "total": 25,
  "page": 1,
  "per_page": 50,
  "pages": 1
}
```

### 未找到音节 (200 OK)

```json
{
  "syllable": "xyz",
  "words": [],
  "total": 0,
  "page": 1,
  "per_page": 50,
  "pages": 0,
  "message": "未找到包含该音节的单词"
}
```

### 错误响应 (400 Bad Request)

```json
{
  "error": "请提供要查询的音节"
}
```

### 认证失败 (401 Unauthorized)

```json
{
  "msg": "Missing Authorization Header"
}
```

---

## 使用示例

### 示例 1：基础查询

**请求：**
```bash
curl -X GET "http://localhost:5000/api/syllables/words?syllable=con" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**响应：**
```json
{
  "syllable": "con",
  "words": [...],
  "total": 25,
  "page": 1,
  "per_page": 50,
  "pages": 1
}
```

---

### 示例 2：分页查询（第2页，每页100条）

**请求：**
```bash
curl -X GET "http://localhost:5000/api/syllables/words?syllable=tion&page=2&per_page=100" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**响应：**
```json
{
  "syllable": "tion",
  "words": [...],
  "total": 150,
  "page": 2,
  "per_page": 100,
  "pages": 2
}
```

---

### 示例 3：使用 Python requests

```python
import requests

# 配置
API_URL = "http://localhost:5000/api/syllables/words"
JWT_TOKEN = "your_jwt_token_here"

# 请求头
headers = {
    "Authorization": f"Bearer {JWT_TOKEN}"
}

# 查询参数
params = {
    "syllable": "con",
    "page": 1,
    "per_page": 50
}

# 发送请求
response = requests.get(API_URL, headers=headers, params=params)

# 处理响应
if response.status_code == 200:
    data = response.json()
    print(f"找到 {data['total']} 个包含 '{data['syllable']}' 的单词")
    for word in data['words']:
        print(f"- {word['word']}: {word['translation']}")
else:
    print(f"错误: {response.json()}")
```

---

### 示例 4：使用 JavaScript/TypeScript (Axios)

```javascript
import axios from 'axios';

const API_URL = 'http://localhost:5000/api/syllables/words';
const JWT_TOKEN = 'your_jwt_token_here';

async function getWordsBySyllable(syllable, page = 1, perPage = 50) {
  try {
    const response = await axios.get(API_URL, {
      params: {
        syllable: syllable,
        page: page,
        per_page: perPage
      },
      headers: {
        'Authorization': `Bearer ${JWT_TOKEN}`
      }
    });
    
    console.log(`找到 ${response.data.total} 个包含 '${response.data.syllable}' 的单词`);
    console.log('单词列表:', response.data.words);
    
    return response.data;
  } catch (error) {
    console.error('查询失败:', error.response?.data || error.message);
    throw error;
  }
}

// 使用示例
getWordsBySyllable('con')
  .then(data => {
    data.words.forEach(word => {
      console.log(`${word.word}: ${word.translation}`);
      console.log(`  音标: ${word.phonetic}`);
      console.log(`  自然拼读: ${word.phonetic_analysis}`);
      console.log(`  词根词缀: ${word.root_affix}`);
      console.log(`  音节: ${word.syllables.join('-')}`);
      console.log('---');
    });
  });
```

---

## 字段说明

### 响应字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| syllable | string | 查询的音节 |
| words | array | 单词列表 |
| total | integer | 总单词数 |
| page | integer | 当前页码 |
| per_page | integer | 每页数量 |
| pages | integer | 总页数 |

### 单词对象字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | integer | 单词ID |
| word | string | 单词文本 |
| translation | string | 中文翻译 |
| phonetic | string | 音标 |
| phonetic_analysis | string | 自然拼读解析（新增） |
| root_affix | string | 词根词缀（新增） |
| syllables | array | 音节列表 |
| created_at | string | 创建时间（ISO 8601格式） |

---

## 特性说明

### ✅ 优点

1. **完整信息：** 返回单词的所有字段，包括新增的自然拼读解析和词根词缀
2. **不记录查询：** 不会增加用户的查询次数统计
3. **支持分页：** 可以处理大量结果，默认每页50条
4. **高性能：** 使用数据库索引和子查询优化性能
5. **友好提示：** 即使音节不存在也返回友好的空结果

### 🎯 使用场景

1. **音节学习：** 查看包含特定音节的所有单词，帮助记忆
2. **单词分类：** 按音节对单词进行分类展示
3. **学习工具：** 开发音节练习、单词分组等学习功能
4. **数据分析：** 分析哪些音节最常出现在单词中

---

## 性能说明

- 查询使用了数据库索引，性能优异
- 对于包含数千个单词的音节，建议使用分页
- 默认按创建时间倒序排列（最新的单词在前）

---

## 注意事项

1. ⚠️ 必须先登录获取 JWT Token
2. ⚠️ 音节查询区分大小写会自动转换为小写
3. ⚠️ 每页最少50条，传入小于50的值会自动调整
4. ℹ️ 此接口不会记录用户的查询统计
5. ℹ️ 返回结果按单词创建时间倒序排列

---

## 相关接口

- `POST /api/words` - 添加单词
- `POST /api/words/lookup` - 智能查询单词
- `GET /api/words` - 获取单词列表
- `GET /api/stats/syllables` - 获取音节查询统计

---

## 版本历史

### v1.0.0 (2025-11-19)
- ✨ 新增音节查询单词接口
- ✨ 支持分页，默认每页50条
- ✨ 返回完整的单词信息，包括自然拼读解析和词根词缀

---

## 联系支持

如有问题或建议，请查看服务器日志或联系技术支持。

